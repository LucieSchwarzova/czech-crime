function callAjax(e,t,n,r){var i="?do=getCrimes";$.ajax({url:i,dataType:"json",data:{areacode:e,crimetype:t,timefrom:n,timeto:r},success:function(e){e.crimesByArea&&populateResultTable($resultTable,e.crimesByArea);e.crimesByTime&&populateResultTable($result2Table,e.crimesByTime)},error:function(e){console.error("ajax error",e)}})}function populateResultTable(e,t){var n=e.find("tbody");n.empty();$.each(t,function(e,t){console.log("data2",t);var r=$("<tr><td>"+t.Code+"</td><td>"+t.Name+"</td><td>"+t.CriminalityIndex+"</td><td>"+t.FoundSum+"</td><td>"+t.SolvedSum+"</td><td>"+t.Population+"</tr>");n.append(r)});e.show()}function resetTables(){var e=$resultTable.find("tbody");e.empty();$resultTable.hide();e=$result2Table.find("tbody");e.empty();$result2Table.hide()}var $apiForm=$("#api-form"),$crimeTypeSelect=$apiForm.find("#crime-type-select"),$areaSelect=$apiForm.find("#area-select"),$timeFromSelect=$apiForm.find("#time-from-select"),$timeToSelect=$apiForm.find("#time-to-select"),$resultTable=$("#result-table"),$result2Table=$("#result2-table");resetTables();$apiForm.on("submit",function(e){e.preventDefault();resetTables();var t=$areaSelect.val(),n=$crimeTypeSelect.val(),r=$timeFromSelect.val(),i=$timeToSelect.val();callAjax(t,n,r,i)});